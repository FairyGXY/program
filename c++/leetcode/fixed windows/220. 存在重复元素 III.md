# [220. å­˜åœ¨é‡å¤å…ƒç´  III](https://leetcode.cn/problems/contains-duplicate-iii/description/)
```
ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸¤ä¸ªæ•´æ•° indexDiff å’Œ valueDiff ã€‚

æ‰¾å‡ºæ»¡è¶³ä¸‹è¿°æ¡ä»¶çš„ä¸‹æ ‡å¯¹ (i, j)ï¼š

i != j,
abs(i - j) <= indexDiff
abs(nums[i] - nums[j]) <= valueDiff
å¦‚æœå­˜åœ¨ï¼Œè¿”å› true ï¼›å¦åˆ™ï¼Œè¿”å› false ã€‚

 

ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼šnums = [1,2,3,1], indexDiff = 3, valueDiff = 0
è¾“å‡ºï¼štrue
è§£é‡Šï¼šå¯ä»¥æ‰¾å‡º (i, j) = (0, 3) ã€‚
æ»¡è¶³ä¸‹è¿° 3 ä¸ªæ¡ä»¶ï¼š
i != j --> 0 != 3
abs(i - j) <= indexDiff --> abs(0 - 3) <= 3
abs(nums[i] - nums[j]) <= valueDiff --> abs(1 - 1) <= 0
ç¤ºä¾‹ 2ï¼š

è¾“å…¥ï¼šnums = [1,5,9,1,5,9], indexDiff = 2, valueDiff = 3
è¾“å‡ºï¼šfalse
è§£é‡Šï¼šå°è¯•æ‰€æœ‰å¯èƒ½çš„ä¸‹æ ‡å¯¹ (i, j) ï¼Œå‡æ— æ³•æ»¡è¶³è¿™ 3 ä¸ªæ¡ä»¶ï¼Œå› æ­¤è¿”å› false ã€‚
 

æç¤ºï¼š

2 <= nums.length <= 105
-109 <= nums[i] <= 109
1 <= indexDiff <= nums.length
0 <= valueDiff <= 109
```
å…ˆçœ‹ä»£ç ï¼š
```cpp
class Solution {
private:
    int getmin(vector<int> vec){
        sort(vec.begin(),vec.end());
        int m=INT_MAX;
        for(int i=1;i<vec.size();i++){
            m=min(m,vec[i]-vec[i-1]);
        }
        return m;
    }
public:
    bool containsNearbyAlmostDuplicate(vector<int>& nums, int indexDiff, int valueDiff) {
        vector<int> vec;
        for(int i=0;i<nums.size();i++){
            vec.push_back(nums[i]);
            if(vec.size()>indexDiff+1){
                vec.erase(vec.begin());
            }
            if(getmin(vec)<=valueDiff)
                return true;
        }
        return false;
    }
};
```
è¿™æ®µä»£ç çš„æ€è·¯æ˜¯ï¼šçª—å£çš„é•¿åº¦ä¸º indexDiff+1 , vec æ•°ç»„é‡Œçš„å…ƒç´ å°±æ˜¯çª—å£å†…çš„å…ƒç´ ï¼Œå¯¹ vec è¿›è¡Œæ’åºï¼Œè¿™æ ·çš„è¯ï¼Œæœ€å°çš„å€¼ä¸€å®šæ˜¯ç›¸é‚»å…ƒç´ çš„å·®å€¼ï¼Œåœ¨åˆ¤æ–­æœ€å°çš„å€¼æ˜¯å¦ <=valueDiff ï¼Œä½†æ˜¯ä»–è¶…æ—¶äº†ã€‚ğŸ˜…

é—® AI åï¼Œå¯ä»¥ç”¨ multiset å®¹å™¨ï¼Œè¿™ä¸ª multiset æ˜¯å¯ä»¥å…è®¸é‡å¤å…ƒç´ å¹¶ä¸”å†…éƒ¨çš„å…ƒç´ æ˜¯æœ‰åºçš„ï¼Œåº•å±‚å®ç°æ˜¯çº¢é»‘æ ‘ï¼Œæ’å…¥ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(logn) ä»£ç ï¼š
```cpp
class Solution {
public:
    bool containsNearbyAlmostDuplicate(vector<int>& nums, int indexDiff, int valueDiff) {
        multiset<int> window;
        for(int i=0;i<nums.size();i++){
            if(i>indexDiff){
                window.erase(window.find(nums[i-indexDiff-1]));
            }
            auto pos = window.lower_bound(nums[i] - valueDiff);
            if (pos != window.end() && *pos <= nums[i] + valueDiff) {
                return true;
            }
            window.insert(nums[i]);
        }
        return false;
    }
};
```
å½“çª—å£çš„é•¿åº¦å¤§äº indexDiff æ—¶ï¼Œçª—å£ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿™é‡Œ`lower_bound(nums[i]-valueDiff])`æ˜¯æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸å°äº`nums[i]-valueDiff`çš„æ•°ï¼Œå› ä¸ºé¢˜ç›®è¯´æ˜`nums[i]-nums[j]<=valueDiff`ï¼Œæ‰€ä»¥ nums[j]>=valueDiffã€‚

è€Œ`*pos<=nums[i]+valueDiff`æ˜¯å› ä¸ºå½“ nums[j]>nums[i] æ—¶ï¼Œ nums[j]-nums[i]<=valueDiff ï¼Œ nums[j]<=nums[i]+valueDiffã€‚
